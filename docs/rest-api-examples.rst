REST API Example Usage
======================

This document summarizes some examples of the cloudigrade REST API.

..
    This document can be regenerated by a developer using the following
    make target from the root directory of a sandbox environment having
    database ports forwarded locally:

    make docs-api-examples

Examples here use the ``http`` command from
`httpie <https://httpie.org/>`_. If you want to follow along with these
exact commands, you may need to ``brew install httpie`` or
``pip install httpie`` first.

These examples also assume you are running cloudigrade on
``localhost:8080`` and that you have correctly configured
cloudigradeâ€™s environment with appropriate variables to allow it to talk
to the various clouds (e.g. ``AWS_ACCESS_KEY_ID``).

Authorization
-------------

The v2 API is authenticated with a custom HTTP header. In order to authenticate,
a `HTTP_X_RH_IDENTITY` header must be included in the request.
This header must be the base64 encoded version of:


.. code:: json

    {
        "identity": {
            "account_number": "1337",
            "user": {
                "is_org_admin": true
            }
        }
    }

.. code:: bash

    HTTP_X_RH_IDENTITY=eyJpZGVudGl0eSI6IHsiYWNjb3VudF9udW1iZXIiOiAiMTMzNyIsICJ1c2VyIjogeyJpc19vcmdfYWRtaW4iOiB0cnVlfX19

Overview
--------

The following resource paths are currently available:

-  ``/api/v2/accounts/`` returns accounts data
-  ``/api/v2/instances/`` returns instances data
-  ``/api/v2/images/`` returns images data
-  ``/api/v2/sysconfig/`` returns sysconfig data
-  ``/api/v2/concurrent/`` returns concurrency data


User Setup
------------------

When accessing any endpoint with the HTTP_X_RH_IDENTITY header,
if the user found in the header does not exist, it will not be created.


Customer Account Info
---------------------

List all accounts
~~~~~~~~~~~~~~~~~

Request:

.. code:: bash

    http localhost:8080/api/cloudigrade/v2/accounts/ "X-RH-IDENTITY:${HTTP_X_RH_IDENTITY}"

Response:

::

    HTTP/1.1 200 OK
    Allow: GET, HEAD, OPTIONS
    Content-Length: 1195
    Content-Type: application/json
    Vary: Accept
    X-CLOUDIGRADE-REQUEST-ID: 27bbf407-ca72-4eaf-aa07-7febddf653b8
    X-Content-Type-Options: nosniff
    X-Frame-Options: DENY

    {
        "data": [
            {
                "account_id": 1,
                "cloud_type": "aws",
                "content_object": {
                    "account_arn": "arn:aws:iam::544771852898:role/role-for-cloudigrade",
                    "aws_account_id": "544771852898",
                    "aws_cloud_account_id": 1,
                    "created_at": "2020-05-04T00:00:00Z",
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-04T00:00:00Z",
                "is_enabled": true,
                "name": "greatest account ever",
                "platform_application_id": 6890,
                "platform_authentication_id": 6311,
                "platform_source_id": 663,
                "updated_at": "2020-05-18T13:51:59.722367Z",
                "user_id": 1
            },
            {
                "account_id": 2,
                "cloud_type": "azure",
                "content_object": {
                    "azure_cloud_account_id": 1,
                    "created_at": "2020-05-04T00:00:00Z",
                    "subscription_id": "67ebc8d4-4df7-4a5b-95e4-e83781234823",
                    "tenant_id": "c1189ecc-40fc-4888-bbb4-cf9ae6254f19",
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-04T00:00:00Z",
                "is_enabled": true,
                "name": "meh account",
                "platform_application_id": 8376,
                "platform_authentication_id": 4242,
                "platform_source_id": 7961,
                "updated_at": "2020-05-18T13:51:59.722367Z",
                "user_id": 1
            }
        ],
        "links": {
            "first": "/api/cloudigrade/api/cloudigrade/v2/accounts/?limit=10&offset=0",
            "last": "/api/cloudigrade/api/cloudigrade/v2/accounts/?limit=10&offset=0",
            "next": null,
            "previous": null
        },
        "meta": {
            "count": 2
        }
    }


Retrieve a specific account
~~~~~~~~~~~~~~~~~~~~~~~~~~~

Request:

.. code:: bash

    http localhost:8080/api/cloudigrade/v2/accounts/1/ "X-RH-IDENTITY:${HTTP_X_RH_IDENTITY}"

Response:

::

    HTTP/1.1 200 OK
    Allow: GET, HEAD, OPTIONS
    Content-Length: 488
    Content-Type: application/json
    Vary: Accept
    X-CLOUDIGRADE-REQUEST-ID: 40145a12-1f5b-4107-9859-2d02d4f93bd1
    X-Content-Type-Options: nosniff
    X-Frame-Options: DENY

    {
        "account_id": 1,
        "cloud_type": "aws",
        "content_object": {
            "account_arn": "arn:aws:iam::544771852898:role/role-for-cloudigrade",
            "aws_account_id": "544771852898",
            "aws_cloud_account_id": 1,
            "created_at": "2020-05-04T00:00:00Z",
            "updated_at": "2020-05-18T13:51:59.722367Z"
        },
        "created_at": "2020-05-04T00:00:00Z",
        "is_enabled": true,
        "name": "greatest account ever",
        "platform_application_id": 6890,
        "platform_authentication_id": 6311,
        "platform_source_id": 663,
        "updated_at": "2020-05-18T13:51:59.722367Z",
        "user_id": 1
    }


Instance Info
-------------

List all instances
~~~~~~~~~~~~~~~~~~

Request:

.. code:: bash

    http localhost:8080/api/cloudigrade/v2/instances/ "X-RH-IDENTITY:${HTTP_X_RH_IDENTITY}"

Response:

::

    HTTP/1.1 200 OK
    Allow: GET, HEAD, OPTIONS
    Content-Length: 2646
    Content-Type: application/json
    Vary: Accept
    X-CLOUDIGRADE-REQUEST-ID: 5d1298e4-2435-4034-a8ac-bbf0e61fbf01
    X-Content-Type-Options: nosniff
    X-Frame-Options: DENY

    {
        "data": [
            {
                "cloud_account_id": 1,
                "cloud_type": "aws",
                "content_object": {
                    "aws_instance_id": 1,
                    "created_at": "2020-05-18T13:51:59.722367Z",
                    "ec2_instance_id": "i-af3bda6fe8102c0fa",
                    "region": "ap-northeast-1",
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-18T13:51:59.722367Z",
                "instance_id": 1,
                "machine_image_id": 1,
                "updated_at": "2020-05-18T13:51:59.722367Z"
            },
            {
                "cloud_account_id": 1,
                "cloud_type": "aws",
                "content_object": {
                    "aws_instance_id": 2,
                    "created_at": "2020-05-18T13:51:59.722367Z",
                    "ec2_instance_id": "i-2af3993a69e2ca795",
                    "region": "ap-northeast-1",
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-18T13:51:59.722367Z",
                "instance_id": 2,
                "machine_image_id": 2,
                "updated_at": "2020-05-18T13:51:59.722367Z"
            },
            {
                "cloud_account_id": 1,
                "cloud_type": "aws",
                "content_object": {
                    "aws_instance_id": 3,
                    "created_at": "2020-05-18T13:51:59.722367Z",
                    "ec2_instance_id": "i-12c876d8efb2a3fa6",
                    "region": "ca-central-1",
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-18T13:51:59.722367Z",
                "instance_id": 3,
                "machine_image_id": 3,
                "updated_at": "2020-05-18T13:51:59.722367Z"
            },
            {
                "cloud_account_id": 2,
                "cloud_type": "azure",
                "content_object": {
                    "azure_instance_id": 1,
                    "created_at": "2020-05-18T13:51:59.722367Z",
                    "region": "North Europe",
                    "resource_id": "/subscriptions/d00f19c8-25da-4238-8bd1-92a2e8ef889a/resourceGroups/if/providers/Microsoft.Compute/virtualMachines/six",
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-18T13:51:59.722367Z",
                "instance_id": 4,
                "machine_image_id": 4,
                "updated_at": "2020-05-18T13:51:59.722367Z"
            },
            {
                "cloud_account_id": 2,
                "cloud_type": "azure",
                "content_object": {
                    "azure_instance_id": 2,
                    "created_at": "2020-05-18T13:51:59.722367Z",
                    "region": "East US",
                    "resource_id": "/subscriptions/9b0531f6-f82f-471f-ba35-bacc0fefad05/resourceGroups/on/providers/Microsoft.Compute/virtualMachines/traditional",
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-18T13:51:59.722367Z",
                "instance_id": 5,
                "machine_image_id": 5,
                "updated_at": "2020-05-18T13:51:59.722367Z"
            },
            {
                "cloud_account_id": 2,
                "cloud_type": "azure",
                "content_object": {
                    "azure_instance_id": 3,
                    "created_at": "2020-05-18T13:51:59.722367Z",
                    "region": "North Europe",
                    "resource_id": "/subscriptions/0a9819b3-fc64-4342-9be7-bb78d6e6eb91/resourceGroups/sense/providers/Microsoft.Compute/virtualMachines/peace",
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-18T13:51:59.722367Z",
                "instance_id": 6,
                "machine_image_id": 6,
                "updated_at": "2020-05-18T13:51:59.722367Z"
            }
        ],
        "links": {
            "first": "/api/cloudigrade/api/cloudigrade/v2/instances/?limit=10&offset=0",
            "last": "/api/cloudigrade/api/cloudigrade/v2/instances/?limit=10&offset=0",
            "next": null,
            "previous": null
        },
        "meta": {
            "count": 6
        }
    }


Retrieve a specific instance
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Request:

.. code:: bash

    http localhost:8080/api/cloudigrade/v2/instances/1/ "X-RH-IDENTITY:${HTTP_X_RH_IDENTITY}"

Response:

::

    HTTP/1.1 200 OK
    Allow: GET, HEAD, OPTIONS
    Content-Length: 355
    Content-Type: application/json
    Vary: Accept
    X-CLOUDIGRADE-REQUEST-ID: 4b5eb006-ee9a-4bdb-a42f-741c7a58b5f5
    X-Content-Type-Options: nosniff
    X-Frame-Options: DENY

    {
        "cloud_account_id": 1,
        "cloud_type": "aws",
        "content_object": {
            "aws_instance_id": 1,
            "created_at": "2020-05-18T13:51:59.722367Z",
            "ec2_instance_id": "i-af3bda6fe8102c0fa",
            "region": "ap-northeast-1",
            "updated_at": "2020-05-18T13:51:59.722367Z"
        },
        "created_at": "2020-05-18T13:51:59.722367Z",
        "instance_id": 1,
        "machine_image_id": 1,
        "updated_at": "2020-05-18T13:51:59.722367Z"
    }


Filtering instances
~~~~~~~~~~~~~~~~~~~

You may also include an optional "running_since" query string argument to filter for only
instances that have been running uninterrupted since the given time.

Request:

.. code:: bash

    http localhost:8080/api/cloudigrade/v2/instances/ "X-RH-IDENTITY:${HTTP_X_RH_IDENTITY}" \
        running_since=="2020-05-18 13:51:59.722367+00:00"

Response:

::

    HTTP/1.1 200 OK
    Allow: GET, HEAD, OPTIONS
    Content-Length: 2402
    Content-Type: application/json
    Vary: Accept
    X-CLOUDIGRADE-REQUEST-ID: 422107f7-355c-4579-b54a-4befe0f58da2
    X-Content-Type-Options: nosniff
    X-Frame-Options: DENY

    {
        "data": [
            {
                "cloud_account_id": 1,
                "cloud_type": "aws",
                "content_object": {
                    "aws_instance_id": 1,
                    "created_at": "2020-05-18T13:51:59.722367Z",
                    "ec2_instance_id": "i-af3bda6fe8102c0fa",
                    "region": "ap-northeast-1",
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-18T13:51:59.722367Z",
                "instance_id": 1,
                "machine_image_id": 1,
                "updated_at": "2020-05-18T13:51:59.722367Z"
            },
            {
                "cloud_account_id": 1,
                "cloud_type": "aws",
                "content_object": {
                    "aws_instance_id": 2,
                    "created_at": "2020-05-18T13:51:59.722367Z",
                    "ec2_instance_id": "i-2af3993a69e2ca795",
                    "region": "ap-northeast-1",
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-18T13:51:59.722367Z",
                "instance_id": 2,
                "machine_image_id": 2,
                "updated_at": "2020-05-18T13:51:59.722367Z"
            },
            {
                "cloud_account_id": 2,
                "cloud_type": "azure",
                "content_object": {
                    "azure_instance_id": 1,
                    "created_at": "2020-05-18T13:51:59.722367Z",
                    "region": "North Europe",
                    "resource_id": "/subscriptions/d00f19c8-25da-4238-8bd1-92a2e8ef889a/resourceGroups/if/providers/Microsoft.Compute/virtualMachines/six",
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-18T13:51:59.722367Z",
                "instance_id": 4,
                "machine_image_id": 4,
                "updated_at": "2020-05-18T13:51:59.722367Z"
            },
            {
                "cloud_account_id": 2,
                "cloud_type": "azure",
                "content_object": {
                    "azure_instance_id": 2,
                    "created_at": "2020-05-18T13:51:59.722367Z",
                    "region": "East US",
                    "resource_id": "/subscriptions/9b0531f6-f82f-471f-ba35-bacc0fefad05/resourceGroups/on/providers/Microsoft.Compute/virtualMachines/traditional",
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-18T13:51:59.722367Z",
                "instance_id": 5,
                "machine_image_id": 5,
                "updated_at": "2020-05-18T13:51:59.722367Z"
            },
            {
                "cloud_account_id": 2,
                "cloud_type": "azure",
                "content_object": {
                    "azure_instance_id": 3,
                    "created_at": "2020-05-18T13:51:59.722367Z",
                    "region": "North Europe",
                    "resource_id": "/subscriptions/0a9819b3-fc64-4342-9be7-bb78d6e6eb91/resourceGroups/sense/providers/Microsoft.Compute/virtualMachines/peace",
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-18T13:51:59.722367Z",
                "instance_id": 6,
                "machine_image_id": 6,
                "updated_at": "2020-05-18T13:51:59.722367Z"
            }
        ],
        "links": {
            "first": "/api/cloudigrade/api/cloudigrade/v2/instances/?limit=10&offset=0&running_since=2020-05-18+13%3A51%3A59.722367%2B00%3A00",
            "last": "/api/cloudigrade/api/cloudigrade/v2/instances/?limit=10&offset=0&running_since=2020-05-18+13%3A51%3A59.722367%2B00%3A00",
            "next": null,
            "previous": null
        },
        "meta": {
            "count": 5
        }
    }


Machine Images
--------------

List all images
~~~~~~~~~~~~~~~

Below command will return all images that have been seen used by any instance for any account belonging to the user that makes the request.

Request:

.. code:: bash

    http localhost:8080/api/cloudigrade/v2/images/ "X-RH-IDENTITY:${HTTP_X_RH_IDENTITY}"

Response:

::

    HTTP/1.1 200 OK
    Allow: GET, HEAD, OPTIONS
    Content-Length: 6750
    Content-Type: application/json
    Vary: Accept
    X-CLOUDIGRADE-REQUEST-ID: 532f97fe-141a-4894-8e28-60e525f220cd
    X-Content-Type-Options: nosniff
    X-Frame-Options: DENY

    {
        "data": [
            {
                "architecture": "x86_64",
                "cloud_type": "aws",
                "content_object": {
                    "aws_image_id": 1,
                    "created_at": "2020-05-18T13:51:59.722367Z",
                    "ec2_ami_id": "ami-7a26774e",
                    "id": 1,
                    "is_cloud_access": false,
                    "is_marketplace": false,
                    "owner_aws_account_id": "544771852898",
                    "platform": "none",
                    "region": null,
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-18T13:51:59.722367Z",
                "image_id": 1,
                "inspection_json": "{\"rhel_enabled_repos_found\": true, \"rhel_version\": \"7.7\", \"syspurpose\": {\"role\": \"Red Hat Enterprise Linux Server\", \"service_level_agreement\": \"Premium\", \"usage\": \"Development/Test\"}}",
                "is_encrypted": false,
                "name": null,
                "openshift": false,
                "openshift_detected": false,
                "rhel": true,
                "rhel_detected": true,
                "rhel_detected_by_tag": false,
                "rhel_enabled_repos_found": true,
                "rhel_product_certs_found": false,
                "rhel_release_files_found": false,
                "rhel_signed_packages_found": false,
                "rhel_version": "7.7",
                "status": "inspected",
                "syspurpose": {
                    "role": "Red Hat Enterprise Linux Server",
                    "service_level_agreement": "Premium",
                    "usage": "Development/Test"
                },
                "updated_at": "2020-05-18T13:51:59.722367Z"
            },
            {
                "architecture": "x86_64",
                "cloud_type": "aws",
                "content_object": {
                    "aws_image_id": 2,
                    "created_at": "2020-05-18T13:51:59.722367Z",
                    "ec2_ami_id": "ami-6518f224",
                    "id": 2,
                    "is_cloud_access": false,
                    "is_marketplace": false,
                    "owner_aws_account_id": "544771852898",
                    "platform": "none",
                    "region": null,
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-18T13:51:59.722367Z",
                "image_id": 2,
                "inspection_json": "{\"rhel_enabled_repos_found\": true, \"rhel_version\": \"7.7\", \"syspurpose\": {\"role\": \"Red Hat Enterprise Linux Server\", \"service_level_agreement\": \"Premium\", \"usage\": \"Development/Test\"}}",
                "is_encrypted": false,
                "name": null,
                "openshift": false,
                "openshift_detected": false,
                "rhel": true,
                "rhel_detected": true,
                "rhel_detected_by_tag": false,
                "rhel_enabled_repos_found": true,
                "rhel_product_certs_found": false,
                "rhel_release_files_found": false,
                "rhel_signed_packages_found": false,
                "rhel_version": "7.7",
                "status": "inspected",
                "syspurpose": {
                    "role": "Red Hat Enterprise Linux Server",
                    "service_level_agreement": "Premium",
                    "usage": "Development/Test"
                },
                "updated_at": "2020-05-18T13:51:59.722367Z"
            },
            {
                "architecture": "x86_64",
                "cloud_type": "aws",
                "content_object": {
                    "aws_image_id": 3,
                    "created_at": "2020-05-18T13:51:59.722367Z",
                    "ec2_ami_id": "ami-70837b5a",
                    "id": 3,
                    "is_cloud_access": false,
                    "is_marketplace": false,
                    "owner_aws_account_id": "544771852898",
                    "platform": "none",
                    "region": null,
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-18T13:51:59.722367Z",
                "image_id": 3,
                "inspection_json": "{\"rhel_enabled_repos_found\": true, \"rhel_version\": \"7.7\", \"syspurpose\": {\"role\": \"Red Hat Enterprise Linux Server\", \"service_level_agreement\": \"Premium\", \"usage\": \"Development/Test\"}}",
                "is_encrypted": false,
                "name": null,
                "openshift": false,
                "openshift_detected": false,
                "rhel": true,
                "rhel_detected": true,
                "rhel_detected_by_tag": false,
                "rhel_enabled_repos_found": true,
                "rhel_product_certs_found": false,
                "rhel_release_files_found": false,
                "rhel_signed_packages_found": false,
                "rhel_version": "7.7",
                "status": "inspected",
                "syspurpose": {
                    "role": "Red Hat Enterprise Linux Server",
                    "service_level_agreement": "Premium",
                    "usage": "Development/Test"
                },
                "updated_at": "2020-05-18T13:51:59.722367Z"
            },
            {
                "architecture": "x86_64",
                "cloud_type": "azure",
                "content_object": {
                    "azure_image_id": 1,
                    "created_at": "2020-05-18T13:51:59.722367Z",
                    "id": 1,
                    "is_marketplace": false,
                    "region": null,
                    "resource_id": "/subscriptions/ae12061f-a230-4bd4-931e-64175ed5fb1d/resourceGroups/field/providers/Microsoft.Compute/images/live",
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-18T13:51:59.722367Z",
                "image_id": 4,
                "inspection_json": "{\"rhel_enabled_repos_found\": true, \"rhel_version\": \"7.7\", \"syspurpose\": {\"role\": \"Red Hat Enterprise Linux Server\", \"service_level_agreement\": \"Premium\", \"usage\": \"Development/Test\"}}",
                "is_encrypted": false,
                "name": null,
                "openshift": false,
                "openshift_detected": false,
                "rhel": true,
                "rhel_detected": true,
                "rhel_detected_by_tag": false,
                "rhel_enabled_repos_found": true,
                "rhel_product_certs_found": false,
                "rhel_release_files_found": false,
                "rhel_signed_packages_found": false,
                "rhel_version": "7.7",
                "status": "inspected",
                "syspurpose": {
                    "role": "Red Hat Enterprise Linux Server",
                    "service_level_agreement": "Premium",
                    "usage": "Development/Test"
                },
                "updated_at": "2020-05-18T13:51:59.722367Z"
            },
            {
                "architecture": "x86_64",
                "cloud_type": "azure",
                "content_object": {
                    "azure_image_id": 2,
                    "created_at": "2020-05-18T13:51:59.722367Z",
                    "id": 2,
                    "is_marketplace": false,
                    "region": null,
                    "resource_id": "/subscriptions/8b6c9e19-d542-4138-92a5-4d596f2e0f80/resourceGroups/measure/providers/Microsoft.Compute/images/example",
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-18T13:51:59.722367Z",
                "image_id": 5,
                "inspection_json": "{\"rhel_enabled_repos_found\": true, \"rhel_version\": \"7.7\", \"syspurpose\": {\"role\": \"Red Hat Enterprise Linux Server\", \"service_level_agreement\": \"Premium\", \"usage\": \"Development/Test\"}}",
                "is_encrypted": false,
                "name": null,
                "openshift": false,
                "openshift_detected": false,
                "rhel": true,
                "rhel_detected": true,
                "rhel_detected_by_tag": false,
                "rhel_enabled_repos_found": true,
                "rhel_product_certs_found": false,
                "rhel_release_files_found": false,
                "rhel_signed_packages_found": false,
                "rhel_version": "7.7",
                "status": "inspected",
                "syspurpose": {
                    "role": "Red Hat Enterprise Linux Server",
                    "service_level_agreement": "Premium",
                    "usage": "Development/Test"
                },
                "updated_at": "2020-05-18T13:51:59.722367Z"
            },
            {
                "architecture": "x86_64",
                "cloud_type": "azure",
                "content_object": {
                    "azure_image_id": 3,
                    "created_at": "2020-05-18T13:51:59.722367Z",
                    "id": 3,
                    "is_marketplace": false,
                    "region": null,
                    "resource_id": "/subscriptions/2bb2ac34-f7c4-4ec9-ad28-d8295787401e/resourceGroups/economy/providers/Microsoft.Compute/images/travel",
                    "updated_at": "2020-05-18T13:51:59.722367Z"
                },
                "created_at": "2020-05-18T13:51:59.722367Z",
                "image_id": 6,
                "inspection_json": "{\"rhel_enabled_repos_found\": true, \"rhel_version\": \"7.7\", \"syspurpose\": {\"role\": \"Red Hat Enterprise Linux Server\", \"service_level_agreement\": \"Premium\", \"usage\": \"Development/Test\"}}",
                "is_encrypted": false,
                "name": null,
                "openshift": false,
                "openshift_detected": false,
                "rhel": true,
                "rhel_detected": true,
                "rhel_detected_by_tag": false,
                "rhel_enabled_repos_found": true,
                "rhel_product_certs_found": false,
                "rhel_release_files_found": false,
                "rhel_signed_packages_found": false,
                "rhel_version": "7.7",
                "status": "inspected",
                "syspurpose": {
                    "role": "Red Hat Enterprise Linux Server",
                    "service_level_agreement": "Premium",
                    "usage": "Development/Test"
                },
                "updated_at": "2020-05-18T13:51:59.722367Z"
            }
        ],
        "links": {
            "first": "/api/cloudigrade/api/cloudigrade/v2/images/?limit=10&offset=0",
            "last": "/api/cloudigrade/api/cloudigrade/v2/images/?limit=10&offset=0",
            "next": null,
            "previous": null
        },
        "meta": {
            "count": 6
        }
    }


Retrieve a specific image
~~~~~~~~~~~~~~~~~~~~~~~~~

Request:

.. code:: bash

    http localhost:8080/api/cloudigrade/v2/images/1/ "X-RH-IDENTITY:${HTTP_X_RH_IDENTITY}"

Response:

::

    HTTP/1.1 200 OK
    Allow: GET, HEAD, OPTIONS
    Content-Length: 1075
    Content-Type: application/json
    Vary: Accept
    X-CLOUDIGRADE-REQUEST-ID: 3950823e-3cc1-4f4a-9f6b-a90bdc219905
    X-Content-Type-Options: nosniff
    X-Frame-Options: DENY

    {
        "architecture": "x86_64",
        "cloud_type": "aws",
        "content_object": {
            "aws_image_id": 1,
            "created_at": "2020-05-18T13:51:59.722367Z",
            "ec2_ami_id": "ami-7a26774e",
            "id": 1,
            "is_cloud_access": false,
            "is_marketplace": false,
            "owner_aws_account_id": "544771852898",
            "platform": "none",
            "region": null,
            "updated_at": "2020-05-18T13:51:59.722367Z"
        },
        "created_at": "2020-05-18T13:51:59.722367Z",
        "image_id": 1,
        "inspection_json": "{\"rhel_enabled_repos_found\": true, \"rhel_version\": \"7.7\", \"syspurpose\": {\"role\": \"Red Hat Enterprise Linux Server\", \"service_level_agreement\": \"Premium\", \"usage\": \"Development/Test\"}}",
        "is_encrypted": false,
        "name": null,
        "openshift": false,
        "openshift_detected": false,
        "rhel": true,
        "rhel_detected": true,
        "rhel_detected_by_tag": false,
        "rhel_enabled_repos_found": true,
        "rhel_product_certs_found": false,
        "rhel_release_files_found": false,
        "rhel_signed_packages_found": false,
        "rhel_version": "7.7",
        "status": "inspected",
        "syspurpose": {
            "role": "Red Hat Enterprise Linux Server",
            "service_level_agreement": "Premium",
            "usage": "Development/Test"
        },
        "updated_at": "2020-05-18T13:51:59.722367Z"
    }


Report Commands
---------------

These APIs may be used to generate calculated and aggregated report data.

Daily Max Concurrency
~~~~~~~~~~~~~~~~~~~~~

The concurrency API returns a paginated list of days, and each day includes the
maximum concurrent number of instances, grouped by various combinations of role,
sla, and architecture seen concurrently in use during that day.

Optional ``start_date`` is an ISO-8601 date that is the inclusive start of the
reporting period. If not defined, default is "today".

Optional ``end_date`` is an ISO-8601 date that is the exclusive end of the
reporting period. If not defined, default is "tomorrow".

Request:

.. code:: bash

    http localhost:8080/api/cloudigrade/v2/concurrent/ "X-RH-IDENTITY:${HTTP_X_RH_IDENTITY}" \
        start_date=="2020-05-11"

Response:

::

    HTTP/1.1 200 OK
    Allow: GET, HEAD, OPTIONS
    Content-Length: 19939
    Content-Type: application/json
    Vary: Accept
    X-CLOUDIGRADE-REQUEST-ID: c62a6e31-5b1d-40d2-9dda-b307e78673c0
    X-Content-Type-Options: nosniff
    X-Frame-Options: DENY

    {
        "data": [
            {
                "date": "2020-05-11",
                "maximum_counts": [
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    }
                ]
            },
            {
                "date": "2020-05-12",
                "maximum_counts": [
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    }
                ]
            },
            {
                "date": "2020-05-13",
                "maximum_counts": [
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    }
                ]
            },
            {
                "date": "2020-05-14",
                "maximum_counts": [
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    }
                ]
            },
            {
                "date": "2020-05-15",
                "maximum_counts": [
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    }
                ]
            },
            {
                "date": "2020-05-16",
                "maximum_counts": []
            },
            {
                "date": "2020-05-17",
                "maximum_counts": [
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    }
                ]
            },
            {
                "date": "2020-05-18",
                "maximum_counts": [
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    }
                ]
            }
        ],
        "links": {
            "first": "/api/cloudigrade/api/cloudigrade/v2/concurrent/?limit=10&offset=0&start_date=2020-05-11",
            "last": "/api/cloudigrade/api/cloudigrade/v2/concurrent/?limit=10&offset=0&start_date=2020-05-11",
            "next": null,
            "previous": null
        },
        "meta": {
            "count": 8
        }
    }

If your requested ``start_date`` and ``end_date`` values would result in some
dates that not completed their calculations, the server will return ``425 Too Early``.

Request:

.. code:: bash

    http localhost:8080/api/cloudigrade/v2/concurrent/ "X-RH-IDENTITY:${HTTP_X_RH_IDENTITY}" \
        start_date=="2020-04-17"

Response:

::

    HTTP/1.1 425
    Allow: GET, HEAD, OPTIONS
    Content-Length: 64
    Content-Type: application/json
    Vary: Accept
    X-CLOUDIGRADE-REQUEST-ID: e0373a17-c6d1-42e3-a0c7-80b2866b814e
    X-Content-Type-Options: nosniff
    X-Frame-Options: DENY

    {
        "detail": "Results are currently unavailable, try again later."
    }

If your requested ``start_date`` and ``end_date`` values would result in some
future dates beyond "today", those future dates will not be included. Daily
max concurrency results will end "today" at the latest. In the following
example, the request is for dates "today" through "one week from today".
This means only one day ("today") is included in the response data.

Request:

.. code:: bash

    http localhost:8080/api/cloudigrade/v2/concurrent/ "X-RH-IDENTITY:${HTTP_X_RH_IDENTITY}" \
        start_date=="2020-05-18" \
        end_date=="2020-05-25"

Response:

::

    HTTP/1.1 200 OK
    Allow: GET, HEAD, OPTIONS
    Content-Length: 3107
    Content-Type: application/json
    Vary: Accept
    X-CLOUDIGRADE-REQUEST-ID: a113f40b-e6ef-4a7c-81e6-06f185aa9192
    X-Content-Type-Options: nosniff
    X-Frame-Options: DENY

    {
        "data": [
            {
                "date": "2020-05-18",
                "maximum_counts": [
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "x86_64",
                        "instances_count": 5,
                        "role": "_ANY",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "_ANY",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "_ANY"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "_ANY",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    },
                    {
                        "arch": "_ANY",
                        "instances_count": 5,
                        "role": "Red Hat Enterprise Linux Server",
                        "service_type": "",
                        "sla": "Premium",
                        "usage": "Development/Test"
                    }
                ]
            }
        ],
        "links": {
            "first": "/api/cloudigrade/api/cloudigrade/v2/concurrent/?end_date=2020-05-25&limit=10&offset=0&start_date=2020-05-18",
            "last": "/api/cloudigrade/api/cloudigrade/v2/concurrent/?end_date=2020-05-25&limit=10&offset=0&start_date=2020-05-18",
            "next": null,
            "previous": null
        },
        "meta": {
            "count": 1
        }
    }

If your requested ``start_date`` and ``end_date`` values would result in exclusively
future dates beyond "today", since those future dates will not be included, zero days
will be included in the response data. In the following example, the request is for
dates "tomorrow" through "one week from today".

Request:

.. code:: bash

    http localhost:8080/api/cloudigrade/v2/concurrent/ "X-RH-IDENTITY:${HTTP_X_RH_IDENTITY}" \
        start_date=="2020-05-19" \
        end_date=="2020-05-25"

Response:

::

    HTTP/1.1 200 OK
    Allow: GET, HEAD, OPTIONS
    Content-Length: 303
    Content-Type: application/json
    Vary: Accept
    X-CLOUDIGRADE-REQUEST-ID: f21d256d-e490-4cec-95ef-1a6a10196ac6
    X-Content-Type-Options: nosniff
    X-Frame-Options: DENY

    {
        "data": [],
        "links": {
            "first": "/api/cloudigrade/api/cloudigrade/v2/concurrent/?end_date=2020-05-25&limit=10&offset=0&start_date=2020-05-19",
            "last": "/api/cloudigrade/api/cloudigrade/v2/concurrent/?end_date=2020-05-25&limit=10&offset=0&start_date=2020-05-19",
            "next": null,
            "previous": null
        },
        "meta": {
            "count": 0
        }
    }

Miscellaneous Commands
----------------------

Retrieve current publicly-viewable system configuration
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The sysconfig endpoint includes the AWS cloud account id used by the application, AWS policies used for acting on behalf of customers, and the currently deployed backend version.

Request:

.. code:: bash

    http localhost:8080/api/cloudigrade/v2/sysconfig/ "X-RH-IDENTITY:${HTTP_X_RH_IDENTITY}"

Response:

::

    HTTP/1.1 200 OK
    Allow: GET, HEAD, OPTIONS
    Content-Length: 608
    Content-Type: application/json
    Vary: Accept
    X-CLOUDIGRADE-REQUEST-ID: 6413b312-216b-4c8c-aabd-ed24976c4ca3
    X-Content-Type-Options: nosniff
    X-Frame-Options: DENY

    {
        "aws_account_id": 434533559245,
        "aws_policies": {
            "traditional_inspection": {
                "Statement": [
                    {
                        "Action": [
                            "ec2:DescribeImages",
                            "ec2:DescribeInstances",
                            "ec2:ModifySnapshotAttribute",
                            "ec2:DescribeSnapshotAttribute",
                            "ec2:DescribeSnapshots",
                            "ec2:CopyImage",
                            "ec2:CreateTags",
                            "ec2:DescribeRegions",
                            "cloudtrail:CreateTrail",
                            "cloudtrail:UpdateTrail",
                            "cloudtrail:PutEventSelectors",
                            "cloudtrail:DescribeTrails",
                            "cloudtrail:StartLogging",
                            "cloudtrail:DeleteTrail"
                        ],
                        "Effect": "Allow",
                        "Resource": "*",
                        "Sid": "CloudigradePolicy"
                    }
                ],
                "Version": "2012-10-17"
            }
        },
        "version": "489-cloudigrade-version - d2b30c637ce3788e22990b21434bac2edcfb7ede"
    }


Internal APIs
-------------

The following APIs are only available internally and are not fully supported.
Caveat emptor. Hic sunt dracones.


Create an AWS account
~~~~~~~~~~~~~~~~~~~~~

This request may take a few seconds because of multiple round-trip calls
to the AWS APIs for each region. The "name" attribute is required and has a
maximum supported length of 256 characters. The "platform_authentication_id",
"platform_application_id", "platform_endpoint_id", and "platform_source_id"
attributes are all required and should be integers.

Request:

.. code:: bash

    http post localhost:8080/internal/api/cloudigrade/v1/accounts/ "X-RH-IDENTITY:${HTTP_X_RH_IDENTITY}" \
        cloud_type="aws" \
        account_arn="arn:aws:iam::101717154503:role/role-for-cloudigrade" \
        name="yet another account" \
        platform_authentication_id="5081" \
        platform_application_id="1618" \
        platform_source_id="1208"

Response:

::

    HTTP/1.1 201 Created
    Allow: GET, POST, HEAD, OPTIONS
    Content-Length: 501
    Content-Type: application/json
    Vary: Accept
    X-CLOUDIGRADE-REQUEST-ID: a15ea3f2-870e-4068-826a-f6bae6527034
    X-Content-Type-Options: nosniff
    X-Frame-Options: DENY

    {
        "account_id": 3,
        "cloud_type": "aws",
        "content_object": {
            "account_arn": "arn:aws:iam::101717154503:role/role-for-cloudigrade",
            "aws_account_id": "101717154503",
            "aws_cloud_account_id": 2,
            "created_at": "2020-05-18T13:51:59.722367Z",
            "updated_at": "2020-05-18T13:51:59.722367Z"
        },
        "created_at": "2020-05-18T13:51:59.722367Z",
        "is_enabled": true,
        "name": "yet another account",
        "platform_application_id": 1618,
        "platform_authentication_id": 5081,
        "platform_source_id": 1208,
        "updated_at": "2020-05-18T13:51:59.722367Z",
        "user_id": 1
    }

If you attempt to create an AWS account for an ARN that is already in
the system, you should get a 400 error.

Request:

.. code:: bash

    http post localhost:8080/internal/api/cloudigrade/v1/accounts/ "X-RH-IDENTITY:${HTTP_X_RH_IDENTITY}" \
        cloud_type="aws" \
        account_arn="arn:aws:iam::101717154503:role/role-for-cloudigrade" \
        name="but this account already exists" \
        platform_authentication_id="1649" \
        platform_application_id="5796" \
        platform_source_id="7113"

Response:

::

    HTTP/1.1 400 Bad Request
    Allow: GET, POST, HEAD, OPTIONS
    Content-Length: 93
    Content-Type: application/json
    Vary: Accept
    X-CLOUDIGRADE-REQUEST-ID: f37817f3-2fcb-4b46-9c8e-9bb027cbb372
    X-Content-Type-Options: nosniff
    X-Frame-Options: DENY

    {
        "account_arn": "Could not set up cloud metering. Please contact support. Error code CG1001."
    }


Create an Azure account
~~~~~~~~~~~~~~~~~~~~~
The "name" attribute is required and has a maximum supported length of 256 characters.
The "platform_authentication_id", "platform_application_id", "platform_endpoint_id",
and "platform_source_id" attributes are all required and should be integers.

Request:

.. code:: bash

    http post localhost:8080/internal/api/cloudigrade/v1/accounts/ "X-RH-IDENTITY:${HTTP_X_RH_IDENTITY}" \
        cloud_type="azure" \
        subscription_id="a1a3167b-c134-4b00-94b2-729e7601374c" \
        tenant_id="ed662fc4-6b6e-4c3f-b574-57ef85245a76" \
        name="it's an azure account" \
        platform_authentication_id="9052" \
        platform_application_id="7815" \
        platform_source_id="7253"

Response:

::

    HTTP/1.1 201 Created
    Allow: GET, POST, HEAD, OPTIONS
    Content-Length: 515
    Content-Type: application/json
    Vary: Accept
    X-CLOUDIGRADE-REQUEST-ID: f53b8bc3-6747-41fb-851e-45e2ab0a0041
    X-Content-Type-Options: nosniff
    X-Frame-Options: DENY

    {
        "account_id": 4,
        "cloud_type": "azure",
        "content_object": {
            "azure_cloud_account_id": 2,
            "created_at": "2020-05-18T13:51:59.722367Z",
            "subscription_id": "a1a3167b-c134-4b00-94b2-729e7601374c",
            "tenant_id": "ed662fc4-6b6e-4c3f-b574-57ef85245a76",
            "updated_at": "2020-05-18T13:51:59.722367Z"
        },
        "created_at": "2020-05-18T13:51:59.722367Z",
        "is_enabled": true,
        "name": "it's an azure account",
        "platform_application_id": 7815,
        "platform_authentication_id": 9052,
        "platform_source_id": 7253,
        "updated_at": "2020-05-18T13:51:59.722367Z",
        "user_id": 1
    }
